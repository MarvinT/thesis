\input{figures/fig01_task_outline.tex}

\subsubsection{Generating smoothly varying morphs}

Using a large corpus of recorded starling song, a generative machine learning model is trained to non-linearly autoencode 400 mS motifs (song segments) of starling song in a low (64) dimensional latent space. The generative model attempts to model the distribution of song segments the model is trained on and as a result it tries to completely fill the latent space with projected representations due to an information bottleneck. The consequence of this is that for any point in the latent space, the spectrogram reconstruction of that point could lie within the actual distribution of starling song. Thus, the model can be used to interpolate between any two arbitrarily chosen starling motifs projected into the latent space to produce a smoothly varying continuum of morphed motifs that shift from one target motif to the other as outlined in \ref{fig:outline}(C). Instead of sounding like a simple linear crossfade between the two motifs, the network tries to produce a motif that could be in the distribution of recorded motifs, resulting in more realistic sounding motifs. Three examples of these smooth morphs are shown in \ref{fig:outline}(E) 

\subsubsection{Behavioral Measurement of Perceptual Space}

Using an operant behavioral apparatus diagrammed in \ref{fig:outline}(B), starlings are trained on a two alternative choice task where four arbitrarily chosen motifs (labeled A, B, C, and D) are associated with a left response and another four (E, F, G, and H), are associated with a right response as summarized in figure \ref{fig:outline}(D). After training to a stable performance criterion, the interpolated morph motifs generated by the \ac{DBN} are used to probe the bird's perception as each left-associated motif is transformed into each right-associated motif. We employed a ratcheting double staircase that \emph{allowed us to iteratively (and independently) estimate the categorical boundary along each of the 16 morph dimensions for each bird}. 

\input{figures/fig02_conserved.tex}

This provides independent binary behavioral responses along each of the 16 possible dimensions interpolating from each of the 4 left associated motifs to each of the right associated motifs.

We fit a \textit{\textbf{psychometric curve}} of the form $P(R) = A + \frac{K - A}{1 + e^{-B(x-M)}}$ using maximum log likelihood for each of the 16 morph dimensions. $A$ and $K$ determine the maximum accuracy achieved near each endpoint. $M$ determines the boundary location or the point of subjective equality between each of the endpoints. $B$ determines boundary sensitivity or slope at the boundary.

A psychometric curve is fit to these behavioral responses and figure \ref{fig:conserved}(A) demonstrates how well a four parameter psychometric curve fits the average response along a single example dimension. We measure 16 of these curves for each bird.

In all cases, birds show very clear categorical perception as evidenced by the steepness each psychometric function regardless of bird or motif dimension. Comparing the psychometric curves within a single bird across all 16 motif-to-motif dimensions reveals a large amount of variation in the point of subjective equality (the category boundary) and in how sensitive the bird is to stimulus changes across the boundary (Fig. \ref{fig:conserved}(B)). This variability across dimensions is presumably a result of the non-linear nature of the \ac{DBN} song compression and morphing. Thus, we can conclude that \emph{the features the DBN uses to represent the motifs are perceptually relevant to the starlings}, and that the starlings are differentially sensitive to variation along these different feature dimensions.

Despite the significant variability within a single bird across multiple morph dimensions, we observed a remarkable degree of consensus between birds.  This included strong agreement in where each bird placed the category boundary on a given dimension, and in the sensitivity of all birds to changes along a given stimulus dimension (slope of psychometric function). Figure \ref{fig:conserved}(C-D) gives an example of the typical agreement between birds, where two of the 16 morph dimensions are plotted for 4 different birds.

Psychometric curves for four starlings, over several months of training, are highly conserved between individuals, suggesting a shared perceptual space. The y-axis shows the probability of a right response to a stimulus morphed continuously between, for example on the left, motif B (reinforced as left) and motif F (reinforced as right). The x-axis is the morph position between the left associated motif to the right associated motif.

$A$ and $K$, the left and right scaling parameters are statistically closer than would be expected when compared across all morphs within a single bird indicating that they are bird specific parameters as demonstrated by supplementary figure \ref{fig:???} and table \ref{tbl:???}. This makes sense because they correspond to the bird's absolute performance on the left and right endpoints. Figure \ref{fig:conserved}(E-F) and table \ref{tbl:???} also show that $M$, the category boundary and $B$, the sensitivity are conserved within the same morph dimension across different birds, but not within a single bird. This indicates the existence of a shared perceptual space of these synthetic natural-like sounds in these wild caught birds. 

\input{figures/fig03_shift.tex}

The shared perceptual space for motif categorization may result from either common training and experience, idiosyncrasies of the compressive network transformation, or some combination of the two. To test for this, we permuted the initial motif category assignments for a subset of birds. Instead of associating motifs A, B, C and D with left responses and motifs E, F, G, and H with right responses, a new cohort of birds learned, for example, to associate motifs A, B, E, and F with left responses and motifs C, D, G, and H with right responses. The category assignments for the three different cohorts are shown in figure \ref{fig:shift}(A). Thus, a subset of the 16 interpolating morph dimensions between left and right associated motifs is shared with the original cohort's interpolating morph dimensions. Comparing these shared boundaries demonstrates that on some of the interpolated morph dimensions, both cohorts of birds place the boundaries in same location as shown in figure \ref{fig:shift}(B) while in other interpolating morph dimensions each cohort has a separate boundary (but consistent within that cohort), as shown in figures \ref{fig:shift}(C-D). The boundaries that are preserved across motif category permutation indicate that these dimensions are independent from the other dimensions, however, the boundaries that are shifted as a result of the motif category permutation indicate an interaction between the interpolated morph dimensions. This is unexpected, especially if one considers that in the latent space of the DBN there is minimal collinearity and no discernable structure between any of the 8 motifs used.


\subsubsection{Electrophysiological Recordings}

\input{figures/fig05_single.tex}

To explore the neural underpinnings of categorical perception we record from secondary auditory regions of anesthetized starlings and present the generated motifs. We record from a total of 2019 neurons in <<<TODO>>> sites in 8 different starlings, 4 trained, 4 naive, never having heard the stimuli before. We use a 32 channel silicon electrode and stereotaxically target \ac{CMM} and \ac{CLM} as described in the methods and shown in figure \ref{fig}. We sort the data using MountainSort\cite{mountainsort}. 

We find the units are extremely time-locked and stimuli specific as demonstrated by figure \ref{fig}. Because of this we choose to include time in our neural representation by convolving the spike train with a Gaussian($\sigma = \SI{10}{ms}$). This provides us with a continuous estimate of firing rate through time for each trial for every unit. If we look at the average of this representation as we move along a morph dimension we find that there is a large amount of variation in how the units respond. Some units respond very smoothly to changes along a morph dimension, whereas others are quite categorical.

We restrict our analysis to units that are able to correctly identify the identity of our eight template motifs (averaged in a pairwise fashion so that 50\% is chance) more than 60\% of the time. This leaves 705 remaining "good" units as seen in figure \ref{fig}.

Using the hold-one-dimension-out prediction strategy, similar to that for the DBN activations, we predicted the behavioral psychometric functions from the neural population representations. The behavioral response is fit given the neural representation of stimuli presented from 15 of the 16 interpolated morph dimensions and then the response is predicted on the neural responses of the remaining dimension. For computational tractability we reduced the dimensionality of the neural representation to 24 dimensions using an LDA-like method. The mean squared error for each held out dimension are combined to provide 16 performances for each neural recording (39?) for each set of behaviorally determined psychometric fits (8). Once again we create a null distribution by shuffling the labels of the morph dimensions 2048 times and measuring the KS distance to distribution of 16 dimension performances. Overall we find the fits are significantly better than would we expected by chance. Furthermore, if we compare the distribution of p values for recordings from untrained naive birds against the recordings of the birds that had been behaviorally trained we find that there's no difference between how well the neural representation of naive birds or trained birds can predict the location of the boundary or the sensitivity to changes near the boundary. That is not to say that there is no difference between the population representation in trained or untrained birds, or that more information about boundary location isn't encoded elsewhere in the brain, but that the information that allows generalization of categorical boundary parameters to other morph dimensions is equally present in both trained and untrained birds.

\subsection{The Thielk Curve}

\input{figures/fig07_derivative.tex}

We are interested in the brain's ability to discriminate changes along our morph dimension. We use distance in our neural representation to approximate the brain's ability to discriminate. 

We pose the following regression problem by defining the Thielk curve
$T(x): x \in D$, such that for a pair of presented stimuli, $a$ and $b$, and a distance, $y$ in neural representation space between these to presentations, $y = \int_a^bT(x)dx + \epsilon$ for $a,b \in \{p_1, p_2, ... p_n\}$ for some small $n$ and $p_i \in D$. This assumes that the neural representation of these stimuli smoothly vary (up to some noise) as I move along the morph dimension. We then perform the regression to minimize the \MSE of $\epsilon$ for all pairs of stimuli presented on a single morph dimension.

We would like the Thielk curve $T(x)$ to have the following properties: 1. Strictly positive. 2. Smooth over the range $D$.
To keep the function positive I have used $T(x)=e^{f(x)}$ and to keep it smooth I have used $f(x)$ as a polynomial of varying orders.
Several other parameterizations have been explored but they provided qualitatively similar results and took significantly longer to fit.

The polynomial parameterization makes the Thielk curve highly susceptible to Runge's phenomenon near the ends of our morph dimension, especially for higher order polynomials. Therefore we do not interpret any spikes near the endpoints of our morph dimension as being meaningful.

- see peaks near psychometric boundaries

- statistically test this

- given a thielk curve, can predict dim without seeing any other data from a recording
- linear prediction (log reg) peaks at 4th order polynomial
- non linear prediction continues to up to our highest tested order 6